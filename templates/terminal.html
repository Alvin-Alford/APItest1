<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terminal - {{ device }}</title>
    <link rel="stylesheet" href="style.css">  </head>
<body>
    <h1>Terminal - {{ device }}</h1>
    <form onsubmit="return false;">
        <input type="text" id="commandInput" placeholder="Enter command">
        <button type="button" onclick="sendCommand()">Send</button>
    </form>
    <div id="commandDisplay"></div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.4/socket.io.min.js"></script>
    <script>
        var socket = io();
        var commandInput = document.getElementById("commandInput");
        var commandDisplayElement = document.getElementById("commandDisplay");
        var commands = [];

        function sendCommand() {
            var command = commandInput.value;
            if (command) {
                var device = '{{ device }}';
                socket.emit('send_command', { command: command, device: device });
                commandInput.value = "";
                commands.push({ command: command, result: "Sending..." });
                commandDisplayElement.innerHTML = renderCommands(commands);
            }
        }

        socket.on('result', function(data) {
            for (var i = 0; i < commands.length; i++) {
                if (commands[i].command === data.Command) {
                    commands[i].result = data.Result;
                    break;
                }
            }
            commandDisplayElement.innerHTML = renderCommands(commands);
        });

        function renderCommands(data) {
            var output = "";
            for (var i = 0; i < data.length; i++) {
                output += "<div class='command-line'>";
                output += "  <span class='command'>Command: " + data[i].command + "</span>";
                output += "  <span class='result'>Result: " + data[i].result + "</span>";
                output += "</div>";
            }
            return output;
        }
    </script>
</body>
</html>
